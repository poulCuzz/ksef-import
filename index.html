<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSeF 2.0 - Import Faktur</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="container">
    <div class="box">
        <h2>KSeF 2.0 - Import Faktur</h2>

        <!-- PRZE≈ÅƒÑCZNIK (NOWY) -->
        <div class="auth-method-switcher">
            <button type="button" class="method-btn active" data-method="token">üîë Token KSeF</button>
            <button type="button" class="method-btn" data-method="certificate">üîê Certyfikat</button>
        </div>

        <form id="exportForm" enctype="multipart/form-data">
            <!-- Pole ukryte - metoda uwierzytelniania (NOWE) -->
            <input type="hidden" name="auth_method" id="auth_method" value="token">

            <div class="form-group">
                <label>≈örodowisko:</label>
                <select name="env" id="env">
                    <option value="demo">DEMO (ksef-demo.mf.gov.pl)</option>
                    <option value="test">TEST (ksef-test.mf.gov.pl)</option>
                </select>
            </div>

            <!-- FORMULARZ TOKENA (domy≈õlnie widoczny) -->
            <div id="token-form" class="auth-form active">
                <div class="form-group">
                    <label>Token KSeF:</label>
                    <input type="text" name="ksef_token" id="ksef_token" placeholder="Wklej sw√≥j token KSeF">
                </div>
            </div>

            <!-- FORMULARZ CERTYFIKATU (NOWY - ukryty domy≈õlnie) -->
            <div id="certificate-form" class="auth-form">
                <div class="form-group">
                    <label>Certyfikat (.crt):</label>
                    <input type="file" name="certificate" id="certificate" accept=".crt,.pem">
                    <label for="certificate" class="file-upload-label">üìÑ Wybierz plik certyfikatu</label>
                    <span class="file-name" id="cert-file-name"></span>
                </div>

                <div class="form-group">
                    <label>Klucz prywatny (.key):</label>
                    <input type="file" name="private_key" id="private_key" accept=".key,.pem">
                    <label for="private_key" class="file-upload-label">üîë Wybierz plik klucza</label>
                    <span class="file-name" id="key-file-name"></span>
                </div>

                <div class="form-group">
                    <label>Has≈Ço do klucza prywatnego:</label>
                    <input type="password" name="key_password" id="key_password" placeholder="Wpisz has≈Ço">
                </div>
            </div>

            <div class="form-group">
                <label>NIP:</label>
                <input type="text" name="nip" id="nip" placeholder="NIP (10 cyfr)" required pattern="[0-9]{10}" maxlength="10">
            </div>

            <div class="form-group">
                <label>Typ podmiotu:</label>
                <select name="subject_type" id="subject_type">
                    <option value="Subject1">Subject1 (Sprzedawca)</option>
                    <option value="Subject2">Subject2 (Nabywca)</option>
                </select>
            </div>

            <div class="date-row">
                <div class="form-group">
                    <label>Data od:</label>
                    <input type="date" name="date_from" id="date_from" required>
                </div>
                <div class="form-group">
                    <label>Data do:</label>
                    <input type="date" name="date_to" id="date_to" required>
                </div>
            </div>

            <button type="submit" id="submitBtn">Importuj faktury</button>
        </form>

        <!-- Status Panel -->
        <div class="status-panel" id="statusPanel">
            <div class="status-header">
                <div class="spinner" id="spinner"></div>
                <div class="checkmark" id="checkmark" style="display:none;">‚úì</div>
                <div class="error-icon" id="errorIcon" style="display:none;">‚úï</div>
                <div class="warning-icon" id="warningIcon" style="display:none;">!</div>
                <div class="info-icon" id="infoIcon" style="display:none;">i</div>
                <span class="status-title" id="statusTitle">Przetwarzanie...</span>
            </div>
            <div class="status-message" id="statusMessage">≈ÅƒÖczenie z KSeF...</div>
            <div class="status-details" id="statusDetails"></div>
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="attempt-counter" id="attemptCounter"></div>
            <!-- Suggestions (pokazuje siƒô przy b≈Çƒôdach) -->
            <div class="suggestions-list" id="suggestionsList" style="display:none;"></div>
            <div class="error-code" id="errorCode"></div>
            <!-- Download list (pokazuje siƒô gdy gotowe) -->
            <div class="download-list" id="downloadList" style="display:none;"></div>
        </div>
    </div>
</div>

<script src="app.js"></script>

</body>
</html>
