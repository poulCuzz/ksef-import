<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSeF 2.0 - Import Faktur</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="container">
    <div class="box">
        <h2>KSeF 2.0 - Import Faktur</h2>

        <!-- PRZE≈ÅƒÑCZNIK -->
        <div class="auth-method-switcher">
            <button type="button" class="method-btn active" data-method="token">üîë Token KSeF</button>
            <button type="button" class="method-btn" data-method="certificate">üîê Certyfikat (.crt + .key)</button>
        </div>

        <form id="exportForm" enctype="multipart/form-data">
            <!-- Pole ukryte - metoda uwierzytelniania -->
            <input type="hidden" name="auth_method" id="auth_method" value="token">

            <div class="form-group">
                <label>≈örodowisko:</label>
                <select name="env" id="env">
                    <option value="prod">PROD </option>
                    <option value="demo">DEMO </option>
                    <option value="test">TEST </option>
                </select>
            </div>

            <!-- FORMULARZ TOKENA (domy≈õlnie widoczny) -->
            <div id="token-form" class="auth-form active">
                <div class="form-group">
                    <label>Token KSeF:</label>
                    <input type="text" name="ksef_token" id="ksef_token" placeholder="Wklej sw√≥j token KSeF">
                </div>
            </div>

            <!-- FORMULARZ CERTYFIKATU .crt + .key (ukryty domy≈õlnie) -->
            <div id="certificate-form" class="auth-form">
                <div class="form-group">
                    <label>Plik certyfikatu (.crt):</label>
                    <div class="file-upload-wrapper">
                        <input type="file" name="cert_file" id="cert_file" accept=".crt,.pem,.cer" class="file-input">
                        <div class="file-upload-box" id="cert_upload_box">
                            <span class="file-upload-icon">üìÑ</span>
                            <span class="file-upload-text">Kliknij lub przeciƒÖgnij plik .crt</span>
                            <span class="file-upload-hint">Akceptowane: .crt, .pem, .cer</span>
                        </div>
                        <div class="file-selected" id="cert_selected" style="display:none;">
                            <span class="file-selected-icon">‚úì</span>
                            <span class="file-selected-name" id="cert_file_name"></span>
                            <button type="button" class="file-remove-btn" id="cert_remove">‚úï</button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Plik klucza prywatnego (.key):</label>
                    <div class="file-upload-wrapper">
                        <input type="file" name="key_file" id="key_file" accept=".key,.pem" class="file-input">
                        <div class="file-upload-box" id="key_upload_box">
                            <span class="file-upload-icon">üîë</span>
                            <span class="file-upload-text">Kliknij lub przeciƒÖgnij plik .key</span>
                            <span class="file-upload-hint">Akceptowane: .key, .pem</span>
                        </div>
                        <div class="file-selected" id="key_selected" style="display:none;">
                            <span class="file-selected-icon">‚úì</span>
                            <span class="file-selected-name" id="key_file_name"></span>
                            <button type="button" class="file-remove-btn" id="key_remove">‚úï</button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Has≈Ço do klucza prywatnego:</label>
                    <input type="password" name="key_password" id="key_password" placeholder="Wpisz has≈Ço do pliku .key (je≈õli wymagane)">
                    <span class="input-hint">Pozostaw puste je≈õli klucz nie jest zabezpieczony has≈Çem</span>
                </div>
            </div>

            <div class="form-group">
                <label>NIP:</label>
                <input type="text" name="nip" id="nip" placeholder="NIP (10 cyfr)" required pattern="[0-9]{10}" maxlength="10">
            </div>

            <div class="form-group">
                <label>Typ podmiotu:</label>
                <select name="subject_type" id="subject_type">
                    <option value="Subject1">Subject1 (Sprzedawca)</option>
                    <option value="Subject2">Subject2 (Nabywca)</option>
                </select>
            </div>

            <div class="date-row">
                <div class="form-group">
                    <label>Data od:</label>
                    <input type="date" name="date_from" id="date_from" required>
                </div>
                <div class="form-group">
                    <label>Data do:</label>
                    <input type="date" name="date_to" id="date_to" required>
                </div>
            </div>

            <button type="submit" id="submitBtn">Importuj faktury</button>
        </form>

        <!-- Status Panel -->
        <div class="status-panel" id="statusPanel">
            <div class="status-header">
                <div class="spinner" id="spinner"></div>
                <div class="checkmark" id="checkmark" style="display:none;">‚úì</div>
                <div class="error-icon" id="errorIcon" style="display:none;">‚úï</div>
                <div class="warning-icon" id="warningIcon" style="display:none;">!</div>
                <div class="info-icon" id="infoIcon" style="display:none;">i</div>
                <span class="status-title" id="statusTitle">Przetwarzanie...</span>
            </div>
            <div class="status-message" id="statusMessage">≈ÅƒÖczenie z KSeF...</div>
            <div class="status-details" id="statusDetails"></div>
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="attempt-counter" id="attemptCounter"></div>
            <!-- Suggestions (pokazuje siƒô przy b≈Çƒôdach) -->
            <div class="suggestions-list" id="suggestionsList" style="display:none;"></div>
            <div class="error-code" id="errorCode"></div>
            <!-- Download list (pokazuje siƒô gdy gotowe) -->
            <div class="download-list" id="downloadList" style="display:none;"></div>
        </div>
    </div>
</div>

<script src="app.js" defer></script>

</body>
</html>
